<!DOCTYPE html>
<html>
  <head>
    <title>TinyVMI Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.41-DEV" />
<title>Update XSM FLASK Policy :: TinyVMI Documentation</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/tinyvmi.github.io\/";
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-79101-13', 'auto');
  ga('send', 'pageview');

</script>

    
  </head>
  <body data-url="/step-by-step/configuration/update-xsm-flask-policy/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="https://tinyvmi.github.io/">TinyVMI Documentation</a>
  

  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/tinyvmi/tinyvmi"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Github repo</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://tinyvmi.github.io/gsoc-blog"  rel="noopener">
                  <i class='fa fa-bookmark'></i> <label>GSoC 2018 Blog</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/quick-start/" class="dd-item alwaysopen
        ">
      <div>
      <a href="/quick-start/">Quick Start</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/step-by-step/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/step-by-step/">Step by Step</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/step-by-step/install-xen-with-flask/" class="dd-item">
        <div>
          <a href="/step-by-step/install-xen-with-flask/">
            Install Xen With FLASK
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
    <li data-nav-id="/step-by-step/configuration/" class="dd-item parent alwaysopen haschildren
        ">
      <div>
      <a href="/step-by-step/configuration/">Configure TinyVMI</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/step-by-step/configuration/update-xsm-flask-policy/" class="dd-item active">
        <div>
          <a href="/step-by-step/configuration/update-xsm-flask-policy/">
            Update XSM FLASK Policy
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/step-by-step/configuration/update-stubdom-makefile/" class="dd-item">
        <div>
          <a href="/step-by-step/configuration/update-stubdom-makefile/">
            Update Stubdom Makefile
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/step-by-step/configuration/update-minios-makefile/" class="dd-item">
        <div>
          <a href="/step-by-step/configuration/update-minios-makefile/">
            Update Mini-OS Makefile
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/step-by-step/configuration/get-target-guest-info/" class="dd-item">
        <div>
          <a href="/step-by-step/configuration/get-target-guest-info/">
            Get Target Guest Info
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/step-by-step/configuration/configure-tinyvmi-with-target-guest-info/" class="dd-item">
        <div>
          <a href="/step-by-step/configuration/configure-tinyvmi-with-target-guest-info/">
            Configure TinyVMI with Target Info
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/step-by-step/run-tinyvmi/" class="dd-item">
        <div>
          <a href="/step-by-step/run-tinyvmi/">
            Build and Run TinyVMI
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section><center>

<a class="github-button" href="https://github.com/tinyvmi/tinyvmi/archive/master.zip" data-icon="octicon-cloud-download" aria-label="Download vjeantet/hugo-theme-docdock on GitHub">Download</a>


<a class="github-button" href="https://github.com/tinyvmi/tinyvmi" data-icon="octicon-star" data-show-count="false" aria-label="Star vjeantet/hugo-theme-docdock on GitHub">Star</a>


<a class="github-button" href="https://github.com/tinyvmi/tinyvmi/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork vjeantet/hugo-theme-docdock on GitHub">Fork</a>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/quick-start/" >
   Quick Start</option> 
  
    <option value="/step-by-step/" >
   Step by Step</option> 
      <option value="/step-by-step/install-xen-with-flask/" >- Install Xen With FLASK</option>
    <option value="/step-by-step/configuration/" >
  - 
   Configure TinyVMI</option> 
      <option value="/step-by-step/configuration/update-xsm-flask-policy/"  selected>-- Update XSM FLASK Policy</option>
      <option value="/step-by-step/configuration/update-stubdom-makefile/" >-- Update Stubdom Makefile</option>
      <option value="/step-by-step/configuration/update-minios-makefile/" >-- Update Mini-OS Makefile</option>
      <option value="/step-by-step/configuration/get-target-guest-info/" >-- Get Target Guest Info</option>
      <option value="/step-by-step/configuration/configure-tinyvmi-with-target-guest-info/" >-- Configure TinyVMI with Target Info</option>
  
      <option value="/step-by-step/run-tinyvmi/" >- Build and Run TinyVMI</option>
  



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/tinyvmi.github.io\/";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>Update XSM FLASK Policy</h1>
    
    
    
    

<div class="panel panel-success">
	<div class="panel-heading">NOTE</div>
	<div class="panel-body"><ul>
<li><p>Before this step, it is required to install Xen with FLASK enabled and to have a guest VM to be monitored by TinyVMI. To do so, see instructions <a href="https://tinyvmi.github.io/step-by-step/install-xen-with-flask/">here</a>.</p></li>

<li><p>The following assumes the XSM FLASK policy is booted from file <code>/boot/flask/xenpolicy</code>. However, the file name can be changed to other ones as shown <a href="https://tinyvmi.github.io/step-by-step/install-xen-with-flask/#update-grub-linux-xen">here</a>. Or can be dynamically loaded after booting via <code>xl loadpolicy &lt;xenpolicy_file&gt;</code>.</p></li>
</ul>
</div>
	
</div>


<h4 id="1-change-policy-in-tools-flask-policy-modules">1. change policy in /tools/flask/policy/modules/</h4>

<pre><code>dom0.te
domU.te
</code></pre>

<p>In general, those two files defines privileges granted to dom0 and domU, respectively. In order to grant enough privileges to TinyVMI as well as dom0, those two files are tentatively changed. An example setup for Xen-4.10.0 can be found from our <a href="https://github.com/tinyvmi/tinyvmi/blob/master/docs/xen-flask/example_policy/xen_4_10">github repo</a>.</p>

<p><div class="panel panel-danger">
	<div class="panel-heading">DANGER</div>
	<div class="panel-body"><p>In our proof-of-concept experiment, TinyVMI and target VM are both labeled with <code>domU</code> for simplicity. However, this is a risky setup where all <code>domUs</code> have same privilege of introspecting other <code>domUs</code> on the same Xen hypervisor. Therefore, this should never be used for any commercial or regular usage on personal PCs.</p>
</div>
	
</div>
</p>

<h4 id="2-build-policy">2. build policy</h4>

<pre><code>apt-get install checkpolicy
cd xen-src/
make -C tools/flask/policy
</code></pre>

<h4 id="3-load-policy">3. load policy</h4>

<p>You can either simply to load it dynamically via:</p>

<pre><code>sudo xl loadpolicy tools/flask/policy/xenpolicy-4.10.0
</code></pre>

<p>OR you can make the system boot with the newest policy by</p>

<pre><code>sudo cp tools/flask/policy/xenpolicy-4.10.0 /boot/flask/
</code></pre>

<p>and change grub options accordingly (see <a href="/step-by-step/install-xen-with-flask/#update-grub">Update Grub Scripts with Xen XSM</a>).</p>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/step-by-step/configuration/" title="Configure TinyVMI"> <i class="fa fa-chevron-left"></i><label>Configure TinyVMI</label></a>
    <a class="nav nav-next" href="/step-by-step/configuration/update-stubdom-makefile/" title="Update Stubdom Makefile" style="margin-right: 0px;"><label>Update Stubdom Makefile</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  
    <div class="date">
        <i class='fa fa-calendar'></i> Last update on 06/04/2018
    </div>
    

    <div class="github-link">
      <a href="https://github.com/tinyvmi/tinyvmi-docs-hugo/edit/master/content/step-by-step/configuration/update-xsm-flask-policy.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
  </div>


	<div>


  
    
  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/theme-flex/script.js"></script>

    

    
    

    
  </body>
</html>